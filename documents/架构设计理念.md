# 架构设计理念

## 设计思想

绒框架处于整个应用链条的底层，所以需要非常严谨的设计和验证。
软件工程架构的设计有很多方法，绒的架构设计思路主要来源于以下几个方面：

- 易经，认识问题方法和解决问题方案提出, 从而得到系统的核心概念
- 数学思想，对概念进行严格推理论证，得到严谨的逻辑和架构组织，并且对概念进行简化和抽象
- 领域驱动设计，对业务领域进行建模，得到领域模型和概念，其中结合易经思想
- 易经中的天地人三才思想，对概念进行编排，使得概念的使用时机（天时）、使用场景（地）、使用方式（人）清晰化，得到系统架构
- 软件工程分层思想，得到模块内部的边界层次，从而得到模块的接口
- 自顶向下设计，解决模块的组成方向问题，得到模块的大致组成，在开发过程中逐步验证，其中能保留的概念大概在70%左右
- 自底向上开发，验证概念和发现新概念，迭代和得到新的概念，得到各种辅助模块和概念
- 易经中的通和活的基本核心思想，得到一个可适应性高的架构

软件工程问题和编程语言无关，和领域问题强相关，所以为了能得到一个能符合影视和游戏领域的架构，需要对问题进行深入认识，用易经和数学的思想得到一组足够简单和有效的概念，然后解决当下这两个领域中的生产流程问题。

## 架构目标

  - 概念规则清晰简单
  - 概念规则通用，减轻学习量
  - 模块化，系统能轻松横向扩展
  - 模块内规则简单，使得模块能够深入领域，进行纵向扩展

截止现在（2023-11-24），架构已经基本成型，其中概念和规则已经基本确定，并且能够满足上述目标。

## 概念

使用易经和数学的思维对概念进行严格论证之后，概念个数和规则个数会非常少和简单。

- 模块：模块是系统的基本组成单位，内含若干个管理，并提供一组管理相关的接口，模块的能力由管理组合而成。
- 管理：管理是模块的基本组成单位，管理代表实际场景中的领域概念，包含要存储的信息数据和对应的操作规则。管理的建模需要领域专家的深入参与和验证。

## 模块组成和概念

  每个模块的组成有以下几个包。核心模块还提供了用于实现的基础支持包，属于实现范畴，和语言、数据库等紧密相关，不应当属于系统设计概念范畴。

- 管理：管理的抽象定义对应cash_core包，核心通用的管理在manage_define包中定义
- 管理器：每个管理对应一个管理器，提供对外的管理接口，管理器对应managers包
- 协议：系统对外接口，对应protocols包，服务对应service_handles包
- 验证：输入请求验证模块，对应validators包
  
几个特殊的包

- 管理的管理：在核心包中，管理的管理也是管理，因其是整个管理系统入口，所以有一个特殊的管理器包：majordomo
- 可见性规则：规则定义在view包中，可见性初始化指定在定义管理时指定，修改通过可见性规则接口修改
  

整个系统的能力在系统运行时体现，概念不代表系统的能力，所以概念不能代表系统的能力，这点在考虑系统能力时需要注意。
概念具有一定的独立性和特性，所以找到一个通用的概念并且建模大部分时候非常困难，需要长时间的研究和验证，这点和数学相似。一旦找到并且建模，使用时会非常简单明了，也和数学相似。